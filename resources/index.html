<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  <link rel="canonical" href="https://webmev.tm4.org/resources/">
  <link rel="shortcut icon" href="../img/favicon.ico">
  <title>General info - WebMeV REST API</title>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700" />

  <link rel="stylesheet" href="../css/theme.css" />
  <link rel="stylesheet" href="../css/theme_extra.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/styles/github.min.css" />
  <link href="../style.css" rel="stylesheet" />
  
  <script>
    // Current page data
    var mkdocs_page_name = "General info";
    var mkdocs_page_input_path = "resources.md";
    var mkdocs_page_url = "/resources/";
  </script>
  
  <script src="../js/jquery-2.1.1.min.js" defer></script>
  <script src="../js/modernizr-2.8.3.min.js" defer></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
        <a href=".." class="icon icon-home"> WebMeV REST API</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="..">Home</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../general_architecture/">Architecture</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Installation and Setup</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../install/">Preliminaries</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../mev_cluster_setup/">Installation and setup</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../setup_configuration/">Configuration</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../management_commands/">Management commands</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../data_server/">Mock data server</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">API</span></p>
                <ul class="current">
                    <li class="toctree-l1"><a class="reference internal" href="../api/">Intro and core concepts</a>
                    </li>
                    <li class="toctree-l1 current"><a class="reference internal current" href="#">Data Structures</a>
    <ul class="current">
                <li class="toctree-l2 current"><a class="reference internal current" href="#">Resources</a>
    <ul class="current">
                <li class="toctree-l3 current"><a class="reference internal current" href="./">General info</a>
    <ul class="current">
    </ul>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../resource_types/">Resource types</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../resource_metadata/">Resource metadata</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../operation_resources/">Operation-associated resources</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../attributes/">Attributes</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../elements/">Observations and Features</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../observation_and_feature_sets/">ObservationSet and FeatureSets</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../workspaces/">Workspaces</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../metadata/">Workspace metadata</a>
                </li>
    </ul>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../auth/">Authentication</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../operations/">Operation concepts</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../creating_analyses/">Creating new analyses/operations</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../example_workflow/">Workflow and analysis concepts</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../public_data/">Creating and managing public data</a>
                    </li>
                </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="..">WebMeV REST API</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="..">Docs</a> &raquo;</li>
    
      
        
          <li>Resources &raquo;</li>
        
      
        
          <li>Data Structures &raquo;</li>
        
      
        
          <li>API &raquo;</li>
        
      
    
    <li>General info</li>
    <li class="wy-breadcrumbs-aside">
      
        <a href="https://github.com/web-mev/mev-backend/edit/master/docs/resources.md"
          class="icon icon-github"> Edit on GitHub</a>
      
    </li>
  </ul>
  
  <hr/>
</div>

          <div role="main">
            <div class="section">
              
                <h3 id="resources"><a class="toclink" href="#resources">Resources</a></h3>
<p><code>Resource</code>s represent data in some file-based format. They come in two types-- those owned by specific users (<code>Resource</code>) and those that are user-independent and associated with analysis operations (<code>OperationResource</code>). Examples of the latter include files for reference genomes, aligner indexes, or other analysis-specific files that a user does not need to maintain or directly interact with.</p>
<p>Much of the information regarding <code>Resource</code> instances is provided in the auto-generated docstring below, but here we highlight some key elements of the <code>Resource</code> model.  Namely, the kinds of operations users and admins can take to create, delete, or otherwise manipulated <code>Resource</code>s via the API.</p>
<p><strong>Resource creation</strong></p>
<ul>
<li>
<p>Regular MEV users can only create <code>Resource</code> instances by uploading files, either via a direct method (upload from local machine) or by using one our cloud-based uploaders (e.g. Dropbox). They can't do this via the API.</p>
</li>
<li>
<p>Admins can "override" and create <code>Resource</code> instances manually via the API.</p>
</li>
<li>
<p>Regardless of who created the <code>Resource</code>, the validation process is started asynchronously.  We cannot assume that the files are properly validated, even if the request was initiated by an admin.</p>
</li>
<li>
<p>Upon creation of the <code>Resource</code>, it is immediately set to "inactive" (<code>is_active = False</code>) while we validate the particular type.</p>
</li>
<li>
<p><code>Resource</code> instances have a single owner, which is the owner who uploaded the file, or directly specified by the admin in the API request. <code>OperationResource</code>s do not have owners, but instead maintain a foreign-key relationship with their associated <code>Operation</code>.</p>
</li>
</ul>
<p><strong>Resource "type"</strong></p>
<ul>
<li>
<p>A <code>Resource</code> is required to have a "type" (e.g. an integer matrix) which we call a <code>resource_type</code>.  These types are restricted to a set of common file formats in addition to more generic text-based formats such as CSV, TSV.  Upon creation, <code>resource_type</code> is set to <code>None</code> which indicates that the <code>Resource</code> has not been validated.</p>
</li>
<li>
<p>The type of the <code>Resource</code> can be specified when the file is uploaded or at any other time (i.e. users can change the type if they desire).  Each request to change type initiates an asynchronous validation process. Note that we can only validate certain types of files, such as CSV and TSV. Validation of sequence-based files such as FastQ and BAM is not feasible and thus we skip validation.</p>
</li>
<li>
<p>If the validation of the <code>resource_type</code> fails, we revert back to the previous successfully validated type.  If the type was previously <code>None</code> (as with a new upload), we simply revert back to <code>None</code> and inform the user the validation failed.</p>
</li>
<li>
<p>Succesfully validated files can sometimes be changed to a convenient internal representation. For instance, we accept expression matrices in multiple formats (e.g. CSV, TSV, XLSX). However, to avoid each analysis <code>Operation</code> from having to parse many potential file formats, we internally convert it to a consistent format, such as TSV. Thus, all the downstream tools expect that the validated resource passed as an input is saved in a TSV/tab-delimited format.</p>
</li>
</ul>
<p><strong>Resources and metadata</strong></p>
<p>Depending on the type of <code>Resource</code>, we are able to infer and extract metadata from the file based on the format. For example, given a validated <code>Resource</code> that represents an RNA-seq count matrix, we assume that the column headers represent samples (<code>Observation</code>s) and the rows represent genes (<code>Feature</code>s). These metadata allow us to create subsets of the <code>Observation</code>s and <code>Feature</code>s for creating experimental contrasts and other typical analysis tasks. More on <code>Observation</code>s and <code>Feature</code>s is <a href="../elements/">described elsewhere.</a></p>
<p><strong>Resources and Workspaces</strong></p>
<ul>
<li>
<p><code>Resource</code> instances are initially "unattached" meaning they are associated with their owner, but have <em>not</em> been associated with any user workspaces.</p>
</li>
<li>
<p>When a user chooses to "add" a <code>Resource</code> to a <code>Workspace</code>, we append the <code>Workspace</code> to the set of <code>Workspace</code> instances associated with that <code>Resource</code>. That is, each <code>Resource</code> tracks which <code>Workspace</code>s it is associated with. This is accomplished via a many-to-many mapping in the database.</p>
</li>
<li>
<p>Users can remove a <code>Resource</code> from a <code>Workspace</code>, but <em>only if it has NOT been used for any portions of the analysis</em>.  We want to retain the completeness of the analysis, so deleting files that are part of the analysis "tree" would create gaps.
Note that removing a <code>Resource</code> from a <code>Workspace</code> does not delete a file- it only modifies the <code>workspaces</code> field on the <code>Resource</code> database instance.</p>
</li>
</ul>
<p><strong>Deletion of Resources</strong></p>
<ul>
<li>
<p><code>Resource</code>s can only be deleted from the file manager on the "home" screen (i.e. not in the Workspace view) in the UI.</p>
</li>
<li>
<p>If a <code>Resource</code> is associated/attached to one or more <code>Workspace</code>s, then you cannot delete the <code>Resource</code>. </p>
</li>
<li>
<p>A <code>Resource</code> can only be deleted if:</p>
</li>
<li>It is associated with zero <code>Workspace</code>s</li>
<li>It is not used in any <code>Operation</code>
Technically, we only need the first case. If a <code>Resource</code> has been used in an <code>Operation</code>, we don't allow the user to remove it from the <code>Workspace</code>. Thus, a file being associated with zero <code>Workspace</code>s means that it has not been used in any <code>Operation</code>s</li>
</ul>
<p><strong>Notes related to backend implementation</strong></p>
<ul>
<li>
<p>In general, the <code>is_active = False</code> flag disallows any updating of the <code>Resource</code> attributes via the API.  All post/patch/put requests will return a 400 status.  This prevents multiple requests from interfering with an ongoing background process, such as validation.</p>
</li>
<li>
<p>Users cannot change the <code>path</code> member.  The actual storage of the files should not matter to the users so they are unable to change the <code>path</code> member.</p>
</li>
</ul>
<div class="autodoc">
<div class="autodoc-signature"><em>class </em><code>api.models.abstract_resource.<strong>AbstractResource</strong></code><span class="autodoc-punctuation">(</span><em class="autodoc-param">*args</em><span class="autodoc-punctuation">, </span><em class="autodoc-param">**kwargs</em><span class="autodoc-punctuation">)</span></div>
<div class="autodoc-docstring"><p>This is the base class which holds common fields for both the user-owned
<code>Resource</code> model and the user-independent <code>OperationResource</code> model.</p></div>
</div>
<div class="autodoc">
<div class="autodoc-signature"><em>class </em><code>api.models.resource.<strong>Resource</strong></code><span class="autodoc-punctuation">(</span><em class="autodoc-param">*args</em><span class="autodoc-punctuation">, </span><em class="autodoc-param">**kwargs</em><span class="autodoc-punctuation">)</span></div>
<div class="autodoc-docstring"><p>A <code>Resource</code> is an abstraction of data.  It represents some
piece of data we are analyzing or manipulating in the course of
an analysis workflow.</p>
<p><code>Resource</code>s are most often represented by flat files, but their
physical storage is not important.  They could be stored locally
or in cloud storage accessible to MEV.</p>
<p>Various "types" of <code>Resource</code>s implement specific constraints
on the data that are important for tracking inputs and outputs of
analyses.  For example, if an analysis module needs to operate on
a matrix of integers, we can enforce that the only <code>Resource</code>s
available as inputs are those identified (and verified) as
<code>IntegerMatrix</code> "types".</p>
<p>Note that we store all types of <code>Resource</code>s in the database as
a single table and maintain the notion of "type" by a
string-field identifier.  Creating specific database tables for
each type of <code>Resource</code> would be unnecessary.  By connecting the
string stored in the database with a concrete implementation class
we can check the type of the <code>Resource</code>.</p>
<p><code>Resource</code>s are not active (<code>is_active</code> flag in the database) until their "type"
has been verified.  API users will submit the intended type with
the request and the backend will check that.  Violations are
reported and the <code>Resource</code> remains inactive (<code>is_active=False</code>).</p></div>
</div>
<div class="autodoc">
<div class="autodoc-signature"><em>class </em><code>api.models.operation_resource.<strong>OperationResource</strong></code><span class="autodoc-punctuation">(</span><em class="autodoc-param">*args</em><span class="autodoc-punctuation">, </span><em class="autodoc-param">**kwargs</em><span class="autodoc-punctuation">)</span></div>
<div class="autodoc-docstring"><p>An <code>OperationResource</code> is a specialization of a <code>Resource</code>
which is not owned by anyone specific, but is rather associated
with a single <code>Operation</code>. Used for things like genome indexes, etc.
where the user is not responsible for supplying or maintaining the
resource.</p>
<p>Note that it maintains a reference to the <code>Operation</code> input field
it corresponds to. This front-end components to easily map the <code>OperationResource</code>
to the proper input field for user selection.</p>
<p>The <code>is_active</code> and <code>is_public</code> fields default to <code>True</code>.</p></div>
</div>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../resource_types/" class="btn btn-neutral float-right" title="Resource types">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../api/" class="btn btn-neutral" title="Intro and core concepts"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
        <span>
          <a href="https://github.com/web-mev/mev-backend/" class="fa fa-github" style="color: #fcfcfc"> GitHub</a>
        </span>
    
    
      <span><a href="../api/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../resource_types/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script>var base_url = '..';</script>
    <script src="../js/theme_extra.js" defer></script>
    <script src="../js/theme.js" defer></script>
      <script src="../search/main.js" defer></script>
    <script defer>
        window.onload = function () {
            SphinxRtdTheme.Navigation.enable(true);
        };
    </script>

</body>
</html>
